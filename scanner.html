<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Leitor ESIP Premium</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<style>
  body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: #0a0d14;
    color: white;
  }

  header {
    background: #003f88;
    padding: 20px;
    text-align: center;
    font-size: 28px;
    font-weight: 700;
    letter-spacing: 1px;
  }

  .container {
    max-width: 600px;
    margin: auto;
    padding: 20px;
  }

  /* Login */
  #loginCard {
    background: #111623;
    padding: 25px;
    border-radius: 18px;
    box-shadow: 0 0 20px rgba(0,0,0,0.5);
    margin-top: 40px;
  }

  #loginCard h2 {
    margin: 0 0 10px;
    font-size: 24px;
  }

  input {
    width: 100%;
    padding: 14px;
    border-radius: 10px;
    border: none;
    margin-top: 12px;
    font-size: 18px;
    background: #1a2030;
    color: white;
  }

  button {
    margin-top: 18px;
    width: 100%;
    padding: 14px;
    font-size: 18px;
    border: none;
    border-radius: 12px;
    background: #0077ff;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    background: #2893ff;
  }

  /* Scanner area */
  #scanSection {
    display: none;
    margin-top: 30px;
  }

  #reader {
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 0 20px rgba(0,0,0,0.6);
  }

  #result {
    margin-top: 20px;
    padding: 18px;
    font-size: 22px;
    font-weight: 600;
    border-radius: 14px;
    text-align: center;
  }

  footer {
    margin-top: 50px;
    text-align: center;
    color: #6f7a90;
    font-size: 14px;
    padding-bottom: 30px;
  }
</style>
</head>
<body>

<header>üì° ESIP - Leitor Oficial Premium</header>

<div class="container">

  <div id="loginCard">
    <h2>üîí Acesso Restrito</h2>
    <p>Digite o c√≥digo para continuar:</p>
    <input id="accessCode" type="password" placeholder="C√≥digo de acesso" />
    <button onclick="validateLogin()">Entrar</button>
    <p id="loginError" style="display:none; color:#ff4e4e; margin-top:10px; font-weight:600;">C√≥digo incorreto!</p>
  </div>

  <div id="scanSection">
    <h2>üì∑ Leitor ESIP</h2>
    <p>Aponte a c√¢mera para o QR Code.</p>
    <div id="reader"></div>
    <div id="result"></div>
  </div>

</div>

<footer>¬© 2025 ESIP - Sistemas Inteligentes</footer>

<script>
const correctCode = "ESIP2025";

function validateLogin() {
  const typed = document.getElementById("accessCode").value;

  if (typed === correctCode) {
    document.getElementById("loginCard").style.display = "none";
    document.getElementById("scanSection").style.display = "block";
    startScanner();
  } else {
    document.getElementById("loginError").style.display = "block";
  }
}

function formatValid(qr) {
  return qr.startsWith("ESIP-");
}

function startScanner() {
  const html5Qr = new Html5Qrcode("reader");

  html5Qr.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 280 },
    (decodedText) => {

      if (!formatValid(decodedText)) {
        showResult(false, "‚ùå C√≥digo inv√°lido!");
        return;
      }

      showResult(true, "‚úÖ Ingresso ESIP v√°lido!");
    }
  ).catch(() => {
    showResult(false, "‚ùå Erro ao acessar c√¢mera. Permita o uso.");
  });
}

function showResult(success, msg) {
  const box = document.getElementById("result");
  box.style.background = success ? "#0fbd7f" : "#ff4e4e";
  box.innerHTML = msg;
}
</script>

</body>
</html>
